{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/add-to-calendar-button@1/assets/css/atcb.min.css">
{% endblock head %}

{% block body %}
<main>
    <h1>{{ title }}</h1>
    <section>
        <h2>Events</h2>
        <div class="grid">
            {% for event in events %}
            <article>
                <h3>{{ event.name }}</h3>
    
                <p>{{ event.datetime.strftime("%H:%M - %A %d %b %Y") }}</p>
                {% if event.location %}
                <p>@ {{ event.location }}</p>
                {% endif %}
                {% if event.url %}
                <a href="{{ event.url }}">View on Facebook</a>
                {% endif %}

                <div class="atcb" style="display: none;">
                    {# As of writing, icsFile only has affect on direct ics downloads. Manual setting is either way required, and thus preferred #}
                    {
                        {# Event info #}
                        "name": "{{ event.name }}",
                        "startDate": "{{ event.datetime.strftime("%Y-%m-%d") }}",
                        "startTime": "{{ event.datetime.strftime("%H:%M") }}",
                        "endTime": "{{ event.endTime().strftime("%H:%M") }}",
                        "location": "{{ event.location }}",
                        "description": "View the Event here: {{ event.clean_url() }}",
                        "timeZone": "{{ timezone }}",

                        {# atcb configuration #}
                        "label": "Add {{ event.name|truncate(12, killwords=False)|escape }} to your Calendar",

                        "options": ["Apple", "Google|Google Calendar", "Microsoft365", "Outlook.com", "Yahoo", "iCal|iCal (.ics file)"],
                        "trigger": "click",
                        "listStyle": "overlay"
                    }
                </div>
            </article>
            {% endfor %}
        </div>
    </section>

    <section id="pages">
        <h2>Pages & communities</h2>
        <p>Check out the pages and communities that organise these events!</p>
        <ul>
            {% for page in pages %}
            <li><a href="{{ page }}">{{ page }}</a></li>
            {% endfor %}
        </ul>
        <p>(Note: this page is not made by the owners of the pages/communities listed above)</p>
    </section>
</main>

<footer class="grid">
    <span>
        Events collected & page generated using
        <a href="https://github.com/Denperidge/facebook-event-aggregator">Facebook Event Aggregator</a>.
    </span>
    <span>CSS Stylesheet by <a href="https://picocss.com/">Pico.css</a></span>
    <span>Calendar buttons by <a href="https://add-to-calendar-button.com/">ATCB</a></span>
</footer>

<!-- https://github.com/add2cal/add-to-calendar-button -->
<script src="https://cdn.jsdelivr.net/npm/add-to-calendar-button@1" async defer></script>
{% endblock body %}